- content_for :title, I18n.t('my_cases.index.my_cases')


.admin.md-container.pt-dark
  %header.md-header
    %h1.admin__title
      = t '.my_cases'

  %aside.md-master
    %h2.admin__title
      = t '.create_a_case'
      = link_to 'https://docs.learngala.com/docs/authoring-getting-started.html',
                class: %i[pt-button pt-minimal pt-icon-help],
                aria: { label: I18n.t('helpers.help') }, target: 'blank' do
        -# Empty

    :markdown
      #{t '.put_your_own_cases_on_gala'}

    = form_with model: Case.new, local: true do |f|
      = f.submit I18n.t('my_cases.index.new_case'),
                 class: 'pt-button pt-intent-success pt-icon-add'

      .pt-select
        = f.select :locale, options_for_select(locale_names, current_user.locale)

  - if @cases.any?
    %main.md-detail
      %table.admin__table.pt-html-table.my-cases__table
        %thead
          %td
          %td= t 'activerecord.attributes.case.case_title'
          %td= t 'activerecord.attributes.case.slug'
          %td= t 'activerecord.attributes.case.locale'
          %td= t 'activerecord.attributes.case.library'
          %td= t 'activerecord.attributes.case.published'
          %td
          %td
          %td

        %tbody
          -@cases.each do |kase|
            %tr
              %td
                %img.admin__table__thumbnail{ src: kase.small_cover_url,
                                              role: 'presentation' }

              %td
                = link_to case_path kase do
                  %span.admin__table__slug
                    = kase.kicker || '—'
                    - if kase.featured?
                      %span.pt-tag.pt-minimal.pt-intent-success
                        = succeed ':' do
                          = t '.featured'
                        = localize kase.featured_at.to_date
                  = kase.title

              %td
                = link_to case_path kase do
                  %code= kase.slug

              %td= Translation.language_name kase.locale

              %td= kase.library.name

              %td{title: kase.published_at}
                - if kase.published?
                  = localize kase.published_at.to_date, format: :long
                - else
                  —

              %td
                = link_to '', edit_case_path(kase),
                          aria: { label: t('.edit_case') },
                          class: 'pt-button pt-minimal pt-icon-edit'

              %td
                = link_to '', edit_case_settings_path(kase),
                          aria: { label: t('.edit_case_settings') },
                          class: 'pt-button pt-minimal pt-icon-cog'

              %td
                = button_to case_path(kase),
                            class: 'pt-button pt-minimal pt-intent-danger pt-icon-trash',
                            aria: { label: t('.delete_case') },
                            data: { confirm: t('.confirm_delete') },
                            disabled: kase.published?,
                            method: :delete do
                  -# This needs to take a block because that makes a <button>
                  -# tag rather than an <input type="submit"> tag

  - else
    %main.md-detail
      .pt-non-ideal-state
        .pt-non-ideal-state-visual.pt-non-ideal-state-icon
          %span.pt-icon.pt-icon-folder-open
        %h4.pt-non-ideal-state-title
          = t '.youre_not_authoring_any_cases'
        .pt-non-ideal-state-description
          = t '.once_youve_created'
