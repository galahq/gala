@import _globals
@import _flexbox
@import _columns
@import _tint_and_shade
@import Catalog

.Card.accepting-selection ::selection
  background-color: #bfaeec

.CommentThreads
  position: absolute
  top: 0
  right: -290px
  background-color: #7351D4
  width: 267px
  color: white
  font-family: $sansFont
  font-weight: 500
  font-size: 12pt
  box-shadow: 0 0.5em 1em rgba(0, 0, 0, 0.3)

  &__footer
    border-top: 1px solid #351D7A
    padding: 0.25em

    & .CommentThreads__new-button.o-button
      width: 100% !important
      background-color: $darkPurple
      margin: 0
      padding: 0.5em
      border-width: 0
      font-size: 11pt
      letter-spacing: 0.4px
      font-weight: 500
      color: white
      &:hover,
      &:focus
        background-color: darken($darkPurple, 10%)
      &:disabled
        cursor: initial
        background-color: transparent

  &__banner
    +banner
    font-family: $sansFont
    top: 0.8em
    @media screen and (max-width: $mobileCutoff)
      top: 0.55em
    padding: 0 0.5rem 0 0.4rem
    font-size: 70%
    color: white !important
    background-color: $purple
    border-left: 0.35rem solid shade($purple, 30%)
    cursor: pointer
    &:hover
      background-color: $purple !important

.CommentThread
  padding: 1.5em
  border: 0.5em solid $purple
  background-color: $white
  position: absolute
  top: 0
  left: 18.1em
  width: 30em
  box-shadow: 0 0.5em 1em rgba(0, 0, 0, 0.3)

  &__back
    position: absolute
    top: 3px
    left: 3px

    & > span
      width: 22px
      height: 22px

  &__submit-button.pt-button
    margin-left: 1em
    @media screen and (max-width: 768px)
      font-size: 0.7em !important

  &__icon-button
    display: flex
    justify-content: center
    align-items: center

    &:hover
      background-color: rgba(0, 0, 0, 0.2)

  form
    margin-top: 1em

    #CommentSubmit
      display: flex
      align-items: flex-end
      margin-bottom: 0.15em

      textarea
        height: 4em
        margin: 0
        padding: 0.5em
        flex: 1
        font-family: $sansFont

        &::-webkit-input-placeholder
          color: $purple

  &__metadata
    margin-bottom: 1em

    &__text
      font-family: $serifFont
      position: relative

      &::before
        content: "“"
        color: black
        position: absolute
        left: -8px

      &::after
        content: "”"
        color: black
        position: absolute
        right: -8px

.Comment
  color: shade($purple, 40%)
  line-height: 90%

  cite
    display: block

  blockquote
    margin: 0
    padding: 0
    border: 0
    line-height: 1.4
    font-weight: 400
    white-space: pre-wrap

  &:not(:first-of-type)
    margin-top: 1em

.Comment i,
.CommentThread__metadata__label
  color: $purple
  font-size: 70%
  font-style: normal
  text-transform: uppercase
  letter-spacing: 0.3px
  margin: 2px 0 0 0
  display: block
  font-weight: 400
  line-height: 1.0

.Comment cite,
.CommentThread form label
  font-size: 95%
  color: shade($purple, 40%)
  font-weight: 700
  font-style: normal
  text-transform: uppercase
  letter-spacing: 0.4px

#Sidebar
  transition: margin-left 0.3s

#Sidebar.has-comments-open
  margin-left: 1em

.CommentThread__back
  display: none

@media screen and (max-width: 2025px)
  #Sidebar.has-comments-open
    margin-left: -10.5em

@media screen and (max-width: 1830px)
  #Sidebar.has-comments-open
    margin-left: -25em

@media screen and (max-width: 1600px)
  .Card.has-comments-open
    flex-basis: 31.8em

  #Sidebar.has-comments-open
    margin-left: -15em

  aside.CommentThread
    width: 30em

@media screen and (max-width: 1439px)
  aside.CommentThread
    width: 25em

@media screen and (max-width: 1364px)
  aside.CommentThread
    width: 20em

@media screen and (max-width: 1279px)
  aside.CommentThread
    left: 0
    width: 22em

  .CommentThread__back
    display: flex

  #Sidebar.has-comment-threads-open
    margin-left: -15em

  .Card.has-comments-open .CommentThreads__window
    display: none

@media screen and (max-width: 1024px)
  aside.CommentThread
    left: 0
    width: 17.5em

  #Sidebar.has-comment-threads-open
    margin-left: -15em

  .Card.has-comment-threads-open
    flex-basis: 23em

@media screen and (max-width: 768px)
  aside.CommentThread
    left: 0
    width: 14.5em

  .Card.has-comment-threads-open
    flex-basis: 13em

  .CommentThreads
    width: 14.5em
    right: -246px

  #Sidebar
    flex-basis: 12rem !important
    &.has-comment-threads-open
      margin-left: -13em

@media screen and (max-width: $mobileCutoff)
  #Sidebar.has-comment-threads-open
    margin-left: 1em

  #Sidebar.has-comments-open
    margin-left: 1em

  .Card.has-comment-threads-open.has-comments-open,
  .Card.has-comment-threads-open
    flex-basis: 100%

  .CommentThreads
    top: inherit
    left: -1px
    right: -1px
    width: auto
    margin-top: 1em

  aside.CommentThread
    display: flex
    justify-content: space-between
    flex-direction: column
    position: absolute
    box-sizing: border-box
    width: calc(100vw - 1em)
