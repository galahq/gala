@import _globals

$stats-indigo-5: #ad99ff
$stats-gray-3: #8a9ba8
$stats-gray-5: #5c7080
$stats-light-gray-4: #dce0e5
$stats-danger: #db3737

@mixin stats-mono
  font-family: monospace

@mixin stats-flex-between
  display: flex
  justify-content: space-between

@mixin stats-center
  display: flex
  align-items: center
  justify-content: center

.c-statistics
  font-weight: 300
  font-family: $sansFont
  text-transform: uppercase
  letter-spacing: 0.25px
  display: flex
  align-items: center
  margin: 0 !important

.c-statistics__icon
  margin-left: .7em
  margin-right: .2em

  &--less-space
    margin-left: .6em
    margin-right: .1em

@mixin recolor-statistics($color: $white)
  .c-statistics
    color: $color

    &:hover
      color: $color

  .c-statistics__icon
    path, circle, ellipse, polyline
      stroke: $color

.s-edgenote
  .o-bottom-right
    bottom: 0.2rem
  @include recolor-statistics($yellow)

.PodcastPlayer, .edge
  @include recolor-statistics($white)

.pt-daterangepicker-shortcuts
  .pt-menu-item > .pt-fill
    width: 100%
    margin-right: 0

.c-stats-date-shortcut-active-0
  .pt-daterangepicker-shortcuts li:nth-child(1) > .pt-menu-item
    background-color: $purple !important
    color: $white !important
    font-weight: 500

.c-stats-date-shortcut-active-1
  .pt-daterangepicker-shortcuts li:nth-child(2) > .pt-menu-item
    background-color: $purple !important
    color: $white !important
    font-weight: 500

.c-stats-date-shortcut-active-2
  .pt-daterangepicker-shortcuts li:nth-child(3) > .pt-menu-item
    background-color: $purple !important
    color: $white !important
    font-weight: 500

.c-stats-date-shortcut-active-3
  .pt-daterangepicker-shortcuts li:nth-child(4) > .pt-menu-item
    background-color: $purple !important
    color: $white !important
    font-weight: 500

.c-stats-date-shortcut-active-4
  .pt-daterangepicker-shortcuts li:nth-child(5) > .pt-menu-item
    background-color: $purple !important
    color: $white !important
    font-weight: 500

.c-stats-picker
  .pt-daterangepicker
    @media (max-width: 639px)
      flex-direction: column

    > div:not(.pt-daterangepicker-shortcuts)
      @media (max-width: 639px)
        flex-direction: column
        align-items: center
        margin-top: 12px
        border: none

.c-stats-filter-card__heading,
.c-stats-information__heading
  margin: 20px 0 10px 0
  font-size: 18px
  font-weight: 600
  color: rgba(16, 22, 26, 0.8)

.c-stats-layout
  display: flex
  flex-direction: column
  gap: 20px
  align-items: flex-start

  @media (min-width: 1200px)
    flex-direction: row
    align-items: stretch

.c-stats-picker
  flex: 1
  min-width: 300px
  max-width: 800px
  width: 100%
  padding: 20px

  @media (min-width: 1200px)
    flex: 1
    min-width: 600px
    max-width: 800px

.c-stats-information-container
  margin-bottom: 20px
  max-width: 1400px

.c-stats-overview-layout
  display: flex
  flex-direction: column
  gap: 20px
  align-items: flex-start

  @media (min-width: 1000px)
    flex-direction: row
    align-items: stretch

.c-stats-information
  min-height: 200px
  min-width: 340px
  max-width: 800px
  padding: 20px

.c-stats-information__card-heading
  margin: 0 0 12px 0
  padding-bottom: 8px
  border-bottom: 1px solid rgba(16, 22, 26, 0.15)
  font-size: 15px
  font-weight: 600
  color: rgba(16, 22, 26, 0.8)

.c-stats-tips
  flex: 0 0 auto
  min-width: 300px
  max-width: 400px

  @media (min-width: 1000px)
    flex: 0 0 350px

.c-stats-summary
  flex: 0 0 auto

  width: 100%
  padding: 20px

  @media (min-width: 1200px)
    flex: 0 0 300px
    max-width: 300px

.c-stats-map-table-card
  margin-top: 20px
  padding: 20px
  max-width: 1400px

.c-stats-map-table-header
  margin-bottom: 16px
  display: flex
  align-items: center
  justify-content: space-between
  flex-wrap: wrap
  gap: 12px

.c-stats-map-table__heading
  margin: 0
  font-size: 15px
  font-weight: 600
  color: rgba(16, 22, 26, 0.8)

.c-stats-map-table__heading .c-stats-map-table__date-range
  font-weight: 400
  color: rgba(92, 112, 128, 0.9)
  font-size: 14px
  margin-left: 10px

.c-stats-map-code-toggle
  display: flex
  align-items: center
  gap: 8px
  font-size: 12px
  color: rgba(92, 112, 128, 0.9)

.c-stats-map-code-toggle__label
  font-weight: 600
  letter-spacing: 0.02em

.c-stats-map-container
  height: 500px
  margin-bottom: 20px
  padding: 0 !important
  overflow: hidden
  width: 100%

.c-stats-map-container--min
  height: 250px

.c-stats-map
  position: relative
  height: 100%
  width: 100%

.c-stats-map__inner
  height: 100%

.c-stats-map-root
  position: relative
  height: 100%
  width: 100%
  cursor: grab
  font-family: var(--pt-font-family, #{$sansFont})

  .mapboxgl-canvas
    cursor: grab !important

    &:active
      cursor: grabbing !important

  .mapboxgl-ctrl-bottom-left
    left: 25px
    opacity: 0.4

  .mapboxgl-ctrl-bottom-right
    position: absolute
    z-index: 1
    bottom: 0px
    right: 28px
    font-size: 9px
    text-transform: uppercase
    letter-spacing: 0.1px

    .mapboxgl-ctrl-attrib
      background-color: transparent

    a
      color: #5c748a

      &:hover
        color: #ebeae4

      &:not(:last-child)
        margin-right: 1em

.c-stats-table-export-layout
  display: flex
  flex-direction: column
  gap: 16px
  align-items: flex-start

  @media (min-width: 768px)
    flex-direction: row-reverse
    align-items: flex-start
    gap: 20px

.c-stats-export-button-container
  display: flex
  justify-content: flex-end
  flex-shrink: 0
  width: 100%

  @media (min-width: 768px)
    width: auto

.c-stats-table-container
  flex: 1
  min-width: 0
  width: 100%
  min-height: 400px

  @media (min-width: 768px)
    flex: 1 1 auto

.c-stats-map__loading-text
  margin-top: 12px
  font-size: 14px

.c-stats-map__loading-text--center
  position: absolute
  top: 50%
  left: 50%
  display: flex
  flex-direction: column
  align-items: center
  gap: 8px
  transform: translate(-50%, -50%)
  color: #6b7280
  margin-top: 0

.c-stats-map-loading-state
  width: 100%
  height: 100%
  min-height: 280px
  display: flex
  flex-direction: column
  align-items: center
  justify-content: center
  gap: 10px

.c-stats-map__overlay
  position: absolute
  top: 0
  left: 0
  right: 0
  bottom: 0
  @include stats-center
  background-color: rgba(249, 250, 251, 0.95)
  z-index: 900

.c-stats-map__overlay--empty
  pointer-events: none

.c-stats-map__overlay--error
  background-color: rgba(249, 250, 251, 0.95)
  pointer-events: auto

.c-stats-summary__content
  font-size: 14px
  line-height: 1.6

.c-stats-summary__header
  margin: 0 0 12px 0
  padding-bottom: 8px
  border-bottom: 1px solid rgba(16, 22, 26, 0.15)
  font-size: 15px
  font-weight: 600

  h3
    margin: 0
    font-size: 15px
    font-weight: 600
    color: rgba(16, 22, 26, 0.8)

  .c-stats-summary__date-range
    font-weight: 400
    color: rgba(92, 112, 128, 0.9)
    font-size: 14px

.c-stats-summary__row
  @include stats-flex-between
  margin-bottom: 8px

  &:last-child
    margin-bottom: 0

.c-stats-summary__label
  font-weight: 400

.c-stats-summary__value
  font-weight: 600

.c-stats-summary__no-data
  color: rgba(28, 29, 29, 0.6)
  font-style: italic
  display: flex
  align-items: center
  justify-content: center
  height: 100%
  min-height: 120px

.c-stats-information__content
  font-size: 14px
  line-height: 1.6

.c-stats-information__row
  @include stats-flex-between
  margin-bottom: 8px

  &:last-child
    margin-bottom: 0

.c-stats-information__label
  font-weight: 400

.c-stats-information__value
  font-weight: 600

.c-stats-centered
  height: 100%
  @include stats-center

.c-stats-table__wrapper
  overflow-x: auto

.c-stats-table
  width: 100%
  font-size: 13px

  th,
  td
    padding: 6px 8px

  @media (max-width: 639px)
    table-layout: fixed

  @media (min-width: 640px)
    font-size: 14px

    th,
    td
      padding: 8px 10px

.c-stats-table__sort-icon
  font-size: 12px

.c-stats-table__sort-icon--inactive
  opacity: 0.3

.c-stats-table__sort-icon--active
  color: $stats-indigo-5
  font-weight: bold

.c-stats-table__sortable
  cursor: pointer
  user-select: none

.c-stats-table__header
  display: flex
  align-items: center
  gap: 4px

.c-stats-table__rank-header
  width: 50px
  text-align: center

.c-stats-table__rank
  text-align: center
  @include stats-mono
  color: $stats-gray-3

.c-stats-table__country-cell
  min-width: 0
  vertical-align: middle

  @media (max-width: 639px)
    vertical-align: top

.c-stats-table__country-content
  display: flex
  align-items: center
  gap: 8px
  min-width: 0
  width: 100%

  @media (max-width: 639px)
    align-items: flex-start
    gap: 6px

.c-stats-table__flag
  width: 20px
  height: 15px
  object-fit: cover
  border-radius: 2px
  border: 1px solid rgba(16, 22, 26, 0.15)
  background: transparent

.c-stats-table__country-name
  min-width: 0
  overflow-wrap: anywhere
  word-break: break-word

  @media (max-width: 639px)
    line-height: 1.3

.c-stats-table__number
  text-align: right
  @include stats-mono

.c-stats-table__unknown-header
  background-color: $stats-light-gray-4
  font-weight: bold
  font-style: italic
  color: $stats-gray-5
  padding-top: 8px
  padding-bottom: 8px

.c-stats-table__total-row
  font-weight: bold

.c-stats-table__total-number
  text-align: right
  @include stats-mono

.c-stats-map-legend
  position: absolute
  bottom: 0
  left: 0
  background: #10161A
  padding: 8px
  border-radius: 0 5px 0 0
  box-shadow: 0 2px 8px rgba(16, 22, 26, 0.35)
  z-index: 3
  min-width: 132px
  width: 176px
  max-width: calc(100vw - 16px)

.c-stats-map-legend__title
  font-weight: bold
  margin-bottom: 6px
  font-size: 12px
  color: rgba(255, 255, 255, 0.95)
  display: flex
  align-items: center
  gap: 6px

.c-stats-map-legend__stack
  display: flex
  align-items: center
  gap: 0
  border-radius: 8px
  overflow: visible
  height: 26px
  background: #000000
  box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.16)
  border: 1px solid rgba(255, 255, 255, 0.18)

.c-stats-map-legend__segment
  display: flex
  align-items: center
  justify-content: center
  height: 100%
  font-size: 9px
  font-weight: 800
  line-height: 1
  padding: 0 4px
  min-width: 1%
  text-shadow: none

.c-stats-map-legend__label
  font-size: 9px
  font-weight: 800
  line-height: 1
  white-space: nowrap

.c-stats-map-legend__ranges
  display: flex
  align-items: flex-start
  gap: 0
  margin-top: 3px
  overflow: visible

.c-stats-map-legend__range
  text-align: center
  font-size: 8px
  font-weight: 600
  line-height: 1
  white-space: nowrap
  padding: 0 2px
  color: rgba(243, 246, 249, 0.92)


.c-stats-map-legend__popover
  padding: 12px
  max-width: 300px

.c-stats-map-legend__popover-heading
  margin-top: 0
  margin-bottom: 8px

.c-stats-map-legend__popover-text
  font-size: 12px

.c-stats-map-legend__help-icon
  cursor: pointer
  opacity: 0.9
  font-size: 8px
  color: rgba(243, 246, 249, 0.92)
  margin: 0 0 0 2px !important
  min-height: 14px !important
  min-width: 14px !important
  padding: 0 !important
  line-height: 1
  background: transparent !important
  box-shadow: none !important

  &:hover,
  &:focus
    opacity: 1
    color: #ffffff
    background: rgba(255, 255, 255, 0.08) !important

.c-stats-map-tooltip
  position: absolute
  background: rgba(23, 31, 39, 0.97)
  color: rgba(243, 246, 249, 0.98)
  border-radius: 8px
  box-shadow: 0 6px 14px rgba(16, 22, 26, 0.35)
  font-size: 10px
  pointer-events: none
  min-width: 168px
  max-width: 210px
  border: 1px solid rgba(138, 155, 168, 0.3)
  overflow: hidden
  z-index: 1000

.c-stats-map-tooltip__country
  font-weight: 700
  font-size: 11px
  line-height: 1.2
  color: #ffffff

.c-stats-map-tooltip__country-row
  display: flex
  align-items: center
  gap: 5px
  padding: 6px 8px
  border-bottom: 1px solid rgba(0, 0, 0, 0.35)

.c-stats-map-tooltip__flag
  width: 20px
  height: 14px
  object-fit: cover
  border-radius: 2px
  border: 1px solid rgba(243, 246, 249, 0.2)

.c-stats-map-tooltip__metric-row
  display: flex
  align-items: center
  justify-content: space-between
  gap: 6px
  padding: 6px 8px 3px

.c-stats-map-tooltip__metric-label
  flex: 1 1 auto
  font-size: 10px
  font-weight: 600
  line-height: 1.1
  color: rgba(243, 246, 249, 0.84)

.c-stats-map-tooltip__metric-pill
  display: inline-flex
  align-items: center
  justify-content: center
  margin-left: auto
  min-width: 24px
  min-height: 24px
  border-radius: 999px
  padding: 0 7px
  font-size: 13px
  font-weight: 800
  line-height: 1
  border: 1px solid rgba(16, 22, 26, 0.22)

.c-stats-map-tooltip__details
  font-size: 9px
  font-weight: 500
  padding: 0 8px 6px
  color: rgba(243, 246, 249, 0.72)

.c-stats-inline-loading
  display: inline-flex
  align-items: center
  gap: 6px

.c-stats-skeleton-card
  padding: 20px
  margin-top: 24px
  min-width: 400px

.c-stats-skeleton--table-header
  height: 20px
  width: 200px
  min-width: 200px
  margin-bottom: 20px

.c-stats-skeleton--table-body
  height: 300px
  min-width: 100%

.c-stats-skeleton--map
  width: 100%
  height: 100%
  min-height: 100%
